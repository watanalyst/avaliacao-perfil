import{u as G,g as i,a as S,b as a,h as J,w as T,d as o,l as K,f as _,e as Q,o as d,F as p,r as f,n as z,t as u,i as m,y as A,k as c,z as C,A as W,q as h,j as X}from"./app-PiHMUUL0.js";import{_ as Y}from"./AuthenticatedLayout-BVhdYX6q.js";const ee={class:"py-8"},oe={class:"mx-auto max-w-5xl sm:px-6 lg:px-8"},te={class:"overflow-hidden rounded-2xl bg-white shadow-lg ring-1 ring-gray-900/5"},le={class:"p-6"},ae={class:"mb-6 flex items-center justify-between"},se={class:"border-b border-gray-200"},ne={class:"-mb-px flex flex-wrap gap-1"},re=["onClick"],ie={class:"space-y-5"},de={class:"relative mt-1"},ue={key:0,class:"mt-1 text-sm text-gray-500"},ce={key:1,class:"absolute z-10 mt-1 w-full overflow-hidden rounded-lg border bg-white shadow-lg"},me=["onClick"],pe={class:"font-semibold text-gray-900"},fe={class:"text-gray-600"},ve={key:0,class:"mt-1 text-sm text-red-600"},be={key:1,class:"mt-1 text-sm text-red-600"},ge={key:2,class:"mt-2 inline-flex items-center gap-1.5 rounded-full bg-brand-50 px-3 py-1 text-xs font-medium text-brand-700"},xe={key:3,class:"mt-3 rounded-lg border border-amber-300 bg-amber-50 p-3"},ye={class:"flex items-start gap-2"},_e={class:"mt-0.5 text-sm text-amber-700"},he={key:0},ke={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},we={key:0,class:"mt-1 text-sm text-red-600"},Ie={key:0,class:"mt-1 text-sm text-red-600"},Ae={class:"space-y-4"},Ce={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},De={class:"block text-sm font-medium text-gray-700"},Ne=["value","onInput","onBlur"],Me={key:0,class:"mt-1 text-sm text-red-600"},Be={class:"space-y-6"},Ue={class:"grid grid-cols-2 gap-4 sm:grid-cols-4"},Fe=["value"],Se=["value"],je=["value"],Oe=["value"],Pe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},Ve={class:"block text-sm font-medium text-gray-700"},$e=["onUpdate:modelValue"],Ee=["value"],Te={class:"space-y-4"},ze={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},Le={class:"block text-sm font-medium text-gray-700"},Re=["value","onInput","onBlur"],qe={class:"space-y-6"},He={class:"mb-3 text-sm font-semibold text-brand-700"},Ze={class:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3"},Ge={class:"block text-sm font-medium text-gray-700"},Je=["value","onInput","onBlur"],Ke={class:"flex items-center gap-3 border-t border-gray-200 pt-6"},Qe=["disabled"],We={key:0,class:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Xe=["disabled"],Ye={key:0,class:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},eo={key:0,class:"text-sm text-gray-400"},lo={__name:"Create",props:{niveis:Array,ancoraTipos:Array,virtudes:Array},setup(D){const j=D,v=h("geral"),L=[{key:"geral",label:"Geral"},{key:"ifp",label:"IFP"},{key:"profiler",label:"Profiler"},{key:"ancoras",label:"Âncoras"},{key:"forcas",label:"Forças Pessoais"}],t=G({numemp:"",tipcol:"",numcad:"",nomfun:"",data_avaliacao:"",observacao:"",status:"RASCUNHO",ifp:{assistencia:null,intracepcao:null,afago:null,autonomia:null,deferencia:null,afiliacao:null,dominancia:null,desempenho:null,exibicao:null,agressao:null,ordem:null,persistencia:null,mudanca:null},profiler:{executor:null,planejador:null,analista:null,comunicador:null,energia_nivel_id:null,exigencia_meio_nivel_id:null,aproveitamento_nivel_id:null,moral_nivel_id:null,positividade_nivel_id:null,flexibilidade_nivel_id:null,amplitude_nivel_id:null,automotivacao_nivel_id:null,incitabilidade_nivel_id:null},ancoras:(j.ancoraTipos||[]).map(n=>({tipo_id:n.ID??n.id,valor:null})),forcas:(j.virtudes||[]).flatMap(n=>(n.forcas||[]).map(e=>({forca_id:e.ID??e.id,valor:null})))});function k(n){if(n==null||n==="")return null;const e=String(n).replace(",","."),l=parseFloat(e);return isNaN(l)?null:l}function b(n,e,l){let s=l.target.value.replace(/\D/g,"");s=s.replace(/^0+/,"")||"0";let r=parseInt(s,10);r>1e4&&(r=1e4);const x=(r/100).toFixed(2).replace(".",",");n[e]=x,l.target.value=x}function g(n,e,l){const s=n[e];if(s==null||s==="")return;let r=k(s);if(r===null){n[e]="0,00",l.target.value="0,00";return}r<0&&(r=0),r>100&&(r=100);const x=r.toFixed(2).replace(".",",");n[e]=x,l.target.value=x}function O(n){for(const e of Object.keys(t.ifp))t.ifp[e]=k(t.ifp[e]);for(const e of["executor","planejador","analista","comunicador"])t.profiler[e]=k(t.profiler[e]);for(const e of t.ancoras)e.valor=k(e.valor);for(const e of t.forcas)e.valor=k(e.valor);t.status=n,t.post(route("avaliacoes.store"))}const R={assistencia:"Assistência",intracepcao:"Intracepção",afago:"Afago",autonomia:"Autonomia",deferencia:"Deferência",afiliacao:"Afiliação",dominancia:"Dominância",desempenho:"Desempenho",exibicao:"Exibição",agressao:"Agressão",ordem:"Ordem",persistencia:"Persistência",mudanca:"Mudança"},q={energia_nivel_id:"Energia",exigencia_meio_nivel_id:"Exigência do Meio",aproveitamento_nivel_id:"Aproveitamento",moral_nivel_id:"Moral",positividade_nivel_id:"Positividade",flexibilidade_nivel_id:"Flexibilidade",amplitude_nivel_id:"Amplitude",automotivacao_nivel_id:"Automotivação",incitabilidade_nivel_id:"Incitabilidade"};function U(n){return t.forcas.findIndex(e=>e.forca_id===n)}const y=h(""),N=h([]),F=h(!1),w=h(!1),M=h(null);let P=null;const B=X(()=>!t.numcad||!t.nomfun?"":`${t.numcad} - ${t.nomfun}`);function I(){N.value=[]}function V(){t.numemp="",t.tipcol="",t.numcad="",t.nomfun="",w.value=!1,M.value=null}async function H(n){const e=n.NUMEMP??n.numemp??"",l=n.TIPCOL??n.tipcol??"",s=n.NUMCAD??n.numcad??"",r=(n.NOMFUN??n.nomfun??"").toString().toUpperCase();t.numemp=e,t.tipcol=l,t.numcad=s,t.nomfun=r,y.value=`${s} - ${r}`,I();try{const x=route("colaboradores.check")+`?numcad=${encodeURIComponent(s)}`,$=await fetch(x,{headers:{Accept:"application/json"}});if($.ok){const E=await $.json();w.value=E.bloqueado,M.value=E.ultima}}catch{}}function Z(){clearTimeout(P),y.value=(y.value||"").toUpperCase();const n=y.value.trim();if(!n){V(),I();return}if(B.value&&n!==B.value&&V(),n.length<2&&!/^\d+$/.test(n)){I();return}P=setTimeout(async()=>{F.value=!0;try{const e=route("colaboradores.index")+`?q=${encodeURIComponent(n)}`,l=await fetch(e,{headers:{Accept:"application/json"}});if(!l.ok){I();return}N.value=await l.json()}finally{F.value=!1}},250)}return(n,e)=>(d(),i(p,null,[S(a(J),{title:"Nova Avaliação"}),S(Y,null,{default:T(()=>[o("div",ee,[o("div",oe,[o("div",te,[e[41]||(e[41]=o("div",{class:"h-1.5 bg-gradient-to-r from-brand-600 via-brand-500 to-brand-700"},null,-1)),o("div",le,[o("div",ae,[e[18]||(e[18]=o("h2",{class:"text-xl font-bold text-gray-900"},"Nova Avaliação",-1)),S(a(K),{href:n.route("avaliacoes.index"),class:"inline-flex items-center gap-1.5 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-50 transition"},{default:T(()=>[...e[17]||(e[17]=[o("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})],-1),_(" Voltar ",-1)])]),_:1},8,["href"])]),o("form",{onSubmit:e[16]||(e[16]=Q(()=>{},["prevent"])),class:"space-y-6"},[o("div",se,[o("nav",ne,[(d(),i(p,null,f(L,l=>o("button",{key:l.key,type:"button",onClick:s=>v.value=l.key,class:z(["rounded-t-lg px-4 py-2.5 text-sm font-semibold transition",v.value===l.key?"border-b-2 border-brand-600 text-brand-600 bg-brand-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},u(l.label),11,re)),64))])]),m(o("div",ie,[o("div",null,[e[24]||(e[24]=o("label",{class:"block text-sm font-medium text-gray-700"},"Colaborador",-1)),o("div",de,[m(o("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),onInput:Z,onBlur:e[1]||(e[1]=()=>n.setTimeout(I,150)),type:"text",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500 uppercase",placeholder:"Digite matrícula ou nome...",autocomplete:"off",spellcheck:"false"},null,544),[[A,y.value]]),F.value?(d(),i("div",ue,"Buscando...")):c("",!0),N.value.length?(d(),i("div",ce,[(d(!0),i(p,null,f(N.value,l=>(d(),i("button",{key:l.NUMCAD??l.numcad,type:"button",class:"block w-full px-4 py-2.5 text-left text-sm hover:bg-brand-50 transition-colors",onClick:s=>H(l)},[o("span",pe,u(l.NUMCAD??l.numcad),1),o("span",fe," — "+u(l.NOMFUN??l.nomfun),1)],8,me))),128))])):c("",!0)]),a(t).errors.numcad?(d(),i("div",ve,u(a(t).errors.numcad),1)):c("",!0),a(t).errors.nomfun?(d(),i("div",be,u(a(t).errors.nomfun),1)):c("",!0),m(o("input",{type:"hidden","onUpdate:modelValue":e[2]||(e[2]=l=>a(t).numcad=l)},null,512),[[A,a(t).numcad]]),m(o("input",{type:"hidden","onUpdate:modelValue":e[3]||(e[3]=l=>a(t).nomfun=l)},null,512),[[A,a(t).nomfun]]),B.value?(d(),i("div",ge,[e[19]||(e[19]=o("svg",{class:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})],-1)),_(" "+u(B.value),1)])):c("",!0),w.value?(d(),i("div",xe,[o("div",ye,[e[23]||(e[23]=o("svg",{class:"mt-0.5 h-5 w-5 flex-shrink-0 text-amber-600",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})],-1)),o("div",null,[e[22]||(e[22]=o("p",{class:"text-sm font-semibold text-amber-800"},"Avaliação bloqueada",-1)),o("p",_e,[e[20]||(e[20]=_(" Este colaborador possui uma avaliação finalizada há menos de 6 meses ",-1)),M.value?(d(),i("span",he,"("+u(M.value)+")",1)):c("",!0),e[21]||(e[21]=_(". Aguarde o prazo para criar uma nova avaliação. ",-1))])])])])):c("",!0)]),o("div",ke,[o("div",null,[e[25]||(e[25]=o("label",{class:"block text-sm font-medium text-gray-700"},"Data da Avaliação",-1)),m(o("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>a(t).data_avaliacao=l),type:"date",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500"},null,512),[[A,a(t).data_avaliacao]]),a(t).errors.data_avaliacao?(d(),i("div",we,u(a(t).errors.data_avaliacao),1)):c("",!0)])]),o("div",null,[e[26]||(e[26]=o("label",{class:"block text-sm font-medium text-gray-700"},"Observação",-1)),m(o("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>a(t).observacao=l),rows:"3",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"Opcional"},null,512),[[A,a(t).observacao]]),a(t).errors.observacao?(d(),i("div",Ie,u(a(t).errors.observacao),1)):c("",!0)])],512),[[C,v.value==="geral"]]),m(o("div",Ae,[e[27]||(e[27]=o("p",{class:"text-sm text-gray-500"}," Preencha os valores do Inventário Fatorial de Personalidade (IFP). ",-1)),o("div",Ce,[(d(),i(p,null,f(R,(l,s)=>o("div",{key:s},[o("label",De,u(l),1),o("input",{value:a(t).ifp[s],onInput:r=>b(a(t).ifp,s,r),onBlur:r=>g(a(t).ifp,s,r),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Ne),a(t).errors[`ifp.${s}`]?(d(),i("div",Me,u(a(t).errors[`ifp.${s}`]),1)):c("",!0)])),64))])],512),[[C,v.value==="ifp"]]),m(o("div",Be,[o("div",null,[e[32]||(e[32]=o("h3",{class:"mb-3 text-sm font-semibold text-gray-800"},"Perfis (%)",-1)),o("div",Ue,[o("div",null,[e[28]||(e[28]=o("label",{class:"block text-sm font-medium text-gray-700"},"Executor",-1)),o("input",{value:a(t).profiler.executor,onInput:e[6]||(e[6]=l=>b(a(t).profiler,"executor",l)),onBlur:e[7]||(e[7]=l=>g(a(t).profiler,"executor",l)),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Fe)]),o("div",null,[e[29]||(e[29]=o("label",{class:"block text-sm font-medium text-gray-700"},"Planejador",-1)),o("input",{value:a(t).profiler.planejador,onInput:e[8]||(e[8]=l=>b(a(t).profiler,"planejador",l)),onBlur:e[9]||(e[9]=l=>g(a(t).profiler,"planejador",l)),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Se)]),o("div",null,[e[30]||(e[30]=o("label",{class:"block text-sm font-medium text-gray-700"},"Analista",-1)),o("input",{value:a(t).profiler.analista,onInput:e[10]||(e[10]=l=>b(a(t).profiler,"analista",l)),onBlur:e[11]||(e[11]=l=>g(a(t).profiler,"analista",l)),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,je)]),o("div",null,[e[31]||(e[31]=o("label",{class:"block text-sm font-medium text-gray-700"},"Comunicador",-1)),o("input",{value:a(t).profiler.comunicador,onInput:e[12]||(e[12]=l=>b(a(t).profiler,"comunicador",l)),onBlur:e[13]||(e[13]=l=>g(a(t).profiler,"comunicador",l)),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Oe)])])]),o("div",null,[e[34]||(e[34]=o("h3",{class:"mb-3 text-sm font-semibold text-gray-800"},"Indicadores de Nível",-1)),o("div",Pe,[(d(),i(p,null,f(q,(l,s)=>o("div",{key:s},[o("label",Ve,u(l),1),m(o("select",{"onUpdate:modelValue":r=>a(t).profiler[s]=r,class:z(["mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",a(t).profiler[s]===null?"text-gray-400":"text-gray-900"])},[e[33]||(e[33]=o("option",{value:null,class:"text-gray-400"},"Selecione...",-1)),(d(!0),i(p,null,f(D.niveis,r=>(d(),i("option",{key:r.ID??r.id,value:r.ID??r.id,class:"text-gray-900"},u(r.DESCRICAO??r.descricao),9,Ee))),128))],10,$e),[[W,a(t).profiler[s]]])])),64))])])],512),[[C,v.value==="profiler"]]),m(o("div",Te,[e[35]||(e[35]=o("p",{class:"text-sm text-gray-500"}," Preencha o valor para cada âncora de carreira. ",-1)),o("div",ze,[(d(!0),i(p,null,f(D.ancoraTipos,(l,s)=>(d(),i("div",{key:l.ID??l.id},[o("label",Le,u(l.NOME??l.nome),1),o("input",{value:a(t).ancoras[s].valor,onInput:r=>b(a(t).ancoras[s],"valor",r),onBlur:r=>g(a(t).ancoras[s],"valor",r),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Re)]))),128))])],512),[[C,v.value==="ancoras"]]),m(o("div",qe,[e[36]||(e[36]=o("p",{class:"text-sm text-gray-500"}," Preencha o valor para cada força pessoal, agrupadas por virtude. ",-1)),(d(!0),i(p,null,f(D.virtudes,l=>(d(),i("div",{key:l.ID??l.id,class:"rounded-lg border border-gray-200 p-4"},[o("h3",He,u(l.NOME??l.nome),1),o("div",Ze,[(d(!0),i(p,null,f(l.forcas,s=>(d(),i("div",{key:s.ID??s.id},[o("label",Ge,u(s.NOME??s.nome),1),o("input",{value:a(t).forcas[U(s.ID??s.id)]?.valor,onInput:r=>b(a(t).forcas[U(s.ID??s.id)],"valor",r),onBlur:r=>g(a(t).forcas[U(s.ID??s.id)],"valor",r),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 text-sm shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Je)]))),128))])]))),128))],512),[[C,v.value==="forcas"]]),o("div",Ke,[o("button",{type:"button",onClick:e[14]||(e[14]=l=>O("RASCUNHO")),disabled:a(t).processing||!a(t).numcad||!a(t).nomfun||w.value,class:"inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-5 py-2.5 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-50 disabled:opacity-50 transition"},[a(t).processing&&a(t).status==="RASCUNHO"?(d(),i("svg",We,[...e[37]||(e[37]=[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):c("",!0),e[38]||(e[38]=_(" Salvar Rascunho ",-1))],8,Qe),o("button",{type:"button",onClick:e[15]||(e[15]=l=>O("FINALIZADA")),disabled:a(t).processing||!a(t).numcad||!a(t).nomfun||w.value,class:"inline-flex items-center gap-2 rounded-lg bg-brand-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-brand-700 disabled:opacity-50 transition"},[a(t).processing&&a(t).status==="FINALIZADA"?(d(),i("svg",Ye,[...e[39]||(e[39]=[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):c("",!0),e[40]||(e[40]=_(" Finalizar Avaliação ",-1))],8,Xe),!a(t).numcad||!a(t).nomfun?(d(),i("span",eo," Selecione um colaborador para habilitar. ")):c("",!0)])],32)])])])])]),_:1})],64))}};export{lo as default};
