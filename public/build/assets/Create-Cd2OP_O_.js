import{u as J,g as i,a as S,b as a,h as K,w as T,d as o,l as Q,f as _,e as W,o as d,F as f,r as v,n as z,t as u,i as m,y as I,k as c,z as A,A as X,q as h,j as Y}from"./app-BFVYraDF.js";import{_ as ee}from"./AuthenticatedLayout-slXQefgB.js";const oe={class:"py-8"},te={class:"mx-auto max-w-5xl sm:px-6 lg:px-8"},le={class:"overflow-hidden rounded-2xl bg-white shadow-lg ring-1 ring-gray-900/5"},ae={class:"p-6"},se={class:"mb-6 flex items-center justify-between"},ne={class:"border-b border-gray-200"},re={class:"-mb-px flex flex-wrap gap-1"},ie=["onClick"],de={class:"space-y-5"},ue={class:"relative mt-1"},ce={key:0,class:"mt-1 text-sm text-gray-500"},me={key:1,class:"absolute z-10 mt-1 w-full overflow-hidden rounded-lg border bg-white shadow-lg"},pe=["onClick"],fe={class:"font-semibold text-gray-900"},ve={class:"text-gray-600"},ge={key:0,class:"mt-1 text-sm text-red-600"},be={key:1,class:"mt-1 text-sm text-red-600"},xe={key:2,class:"mt-2 inline-flex items-center gap-1.5 rounded-full bg-brand-50 px-3 py-1 text-xs font-medium text-brand-700"},ye={key:3,class:"mt-3 rounded-lg border border-amber-300 bg-amber-50 p-3"},_e={class:"flex items-start gap-2"},he={class:"mt-0.5 text-sm text-amber-700"},ke={key:0},we={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Ie={key:0,class:"mt-1 text-sm text-red-600"},Ae={key:0,class:"mt-1 text-sm text-red-600"},Ce={class:"space-y-4"},De={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},Ne={class:"block text-sm font-medium text-gray-700"},Me=["value","onInput"],Ue={key:0,class:"mt-1 text-sm text-red-600"},Be={class:"space-y-6"},Fe={class:"grid grid-cols-2 gap-4 sm:grid-cols-4"},Se=["value"],je=["value"],Oe=["value"],Ve=["value"],$e={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},Pe={class:"block text-sm font-medium text-gray-700"},Ee=["onUpdate:modelValue"],Te=["value"],ze={class:"space-y-4"},Le={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},Re={class:"block text-sm font-medium text-gray-700"},qe=["value","onInput","onBlur"],He={class:"space-y-6"},Ze={class:"mb-3 text-sm font-semibold text-brand-700"},Ge={class:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3"},Je={class:"block text-sm font-medium text-gray-700"},Ke=["value","onInput","onBlur"],Qe={class:"flex items-center gap-3 border-t border-gray-200 pt-6"},We=["disabled"],Xe={key:0,class:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Ye=["disabled"],eo={key:0,class:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},oo={key:0,class:"text-sm text-gray-400"},ao={__name:"Create",props:{niveis:Array,ancoraTipos:Array,virtudes:Array},setup(C){const j=C,g=h("geral"),L=[{key:"geral",label:"Geral"},{key:"ifp",label:"IFP"},{key:"profiler",label:"Profiler"},{key:"ancoras",label:"Âncoras"},{key:"forcas",label:"Forças Pessoais"}],l=J({numemp:"",tipcol:"",numcad:"",nomfun:"",data_avaliacao:"",observacao:"",status:"RASCUNHO",ifp:{assistencia:null,intracepcao:null,afago:null,autonomia:null,deferencia:null,afiliacao:null,dominancia:null,desempenho:null,exibicao:null,agressao:null,ordem:null,persistencia:null,mudanca:null},profiler:{executor:null,planejador:null,analista:null,comunicador:null,energia_nivel_id:null,exigencia_meio_nivel_id:null,aproveitamento_nivel_id:null,autoconfianca_nivel_id:null,autoestima_nivel_id:null,flexibilidade_nivel_id:null,amplitude_nivel_id:null,automotivacao_nivel_id:null,incitabilidade_nivel_id:null},ancoras:(j.ancoraTipos||[]).map(n=>({tipo_id:n.ID??n.id,valor:null})),forcas:(j.virtudes||[]).flatMap(n=>(n.forcas||[]).map(e=>({forca_id:e.ID??e.id,valor:null})))});function D(n){if(n==null||n==="")return null;const e=String(n).replace(",","."),t=parseFloat(e);return isNaN(t)?null:t}function R(n,e,t){let s=t.target.value.replace(/\D/g,"");s=s.replace(/^0+/,"")||"0";let r=parseInt(s,10);r>100&&(r=100);const p=String(r);n[e]=p,t.target.value=p}function b(n,e,t){let s=t.target.value.replace(/\D/g,"");s=s.replace(/^0+/,"")||"0";let r=parseInt(s,10);r>1e4&&(r=1e4);const p=(r/100).toFixed(2).replace(".",",");n[e]=p,t.target.value=p}function x(n,e,t){const s=n[e];if(s==null||s==="")return;let r=D(s);if(r===null){n[e]="0,00",t.target.value="0,00";return}r<0&&(r=0),r>100&&(r=100);const p=r.toFixed(2).replace(".",",");n[e]=p,t.target.value=p}function O(n){for(const e of Object.keys(l.ifp)){const t=l.ifp[e];l.ifp[e]=t==null||t===""?null:parseInt(t,10)}for(const e of["executor","planejador","analista","comunicador"])l.profiler[e]=D(l.profiler[e]);for(const e of l.ancoras)e.valor=D(e.valor);for(const e of l.forcas)e.valor=D(e.valor);l.status=n,l.post(route("avaliacoes.store"))}const q={assistencia:"Assistência",intracepcao:"Intracepção",afago:"Afago",deferencia:"Deferência",afiliacao:"Afiliação",dominancia:"Dominância",desempenho:"Desempenho",exibicao:"Exibição",agressao:"Agressão",ordem:"Ordem",persistencia:"Persistência",mudanca:"Mudança",autonomia:"Autonomia"},H={energia_nivel_id:"Energia",exigencia_meio_nivel_id:"Exigência do Meio",aproveitamento_nivel_id:"Aproveitamento",autoconfianca_nivel_id:"Autoconfiança",autoestima_nivel_id:"Autoestima",flexibilidade_nivel_id:"Flexibilidade",amplitude_nivel_id:"Amplitude",automotivacao_nivel_id:"Automotivação",incitabilidade_nivel_id:"Incitabilidade"};function B(n){return l.forcas.findIndex(e=>e.forca_id===n)}const y=h(""),N=h([]),F=h(!1),k=h(!1),M=h(null);let V=null;const U=Y(()=>!l.numcad||!l.nomfun?"":`${l.numcad} - ${l.nomfun}`);function w(){N.value=[]}function $(){l.numemp="",l.tipcol="",l.numcad="",l.nomfun="",k.value=!1,M.value=null}async function Z(n){const e=n.NUMEMP??n.numemp??"",t=n.TIPCOL??n.tipcol??"",s=n.NUMCAD??n.numcad??"",r=(n.NOMFUN??n.nomfun??"").toString().toUpperCase();l.numemp=e,l.tipcol=t,l.numcad=s,l.nomfun=r,y.value=`${s} - ${r}`,w();try{const p=route("colaboradores.check")+`?numcad=${encodeURIComponent(s)}`,P=await fetch(p,{headers:{Accept:"application/json"}});if(P.ok){const E=await P.json();k.value=E.bloqueado,M.value=E.ultima}}catch{}}function G(){clearTimeout(V),y.value=(y.value||"").toUpperCase();const n=y.value.trim();if(!n){$(),w();return}if(U.value&&n!==U.value&&$(),n.length<2&&!/^\d+$/.test(n)){w();return}V=setTimeout(async()=>{F.value=!0;try{const e=route("colaboradores.index")+`?q=${encodeURIComponent(n)}`,t=await fetch(e,{headers:{Accept:"application/json"}});if(!t.ok){w();return}N.value=await t.json()}finally{F.value=!1}},250)}return(n,e)=>(d(),i(f,null,[S(a(K),{title:"Nova Avaliação"}),S(ee,null,{default:T(()=>[o("div",oe,[o("div",te,[o("div",le,[e[41]||(e[41]=o("div",{class:"h-1.5 bg-gradient-to-r from-brand-600 via-brand-500 to-brand-700"},null,-1)),o("div",ae,[o("div",se,[e[18]||(e[18]=o("h2",{class:"text-xl font-bold text-gray-900"},"Nova Avaliação",-1)),S(a(Q),{href:n.route("avaliacoes.index"),class:"inline-flex items-center gap-1.5 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-50 transition"},{default:T(()=>[...e[17]||(e[17]=[o("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})],-1),_(" Voltar ",-1)])]),_:1},8,["href"])]),o("form",{onSubmit:e[16]||(e[16]=W(()=>{},["prevent"])),class:"space-y-6"},[o("div",ne,[o("nav",re,[(d(),i(f,null,v(L,t=>o("button",{key:t.key,type:"button",onClick:s=>g.value=t.key,class:z(["rounded-t-lg px-4 py-2.5 text-sm font-semibold transition",g.value===t.key?"border-b-2 border-brand-600 text-brand-600 bg-brand-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},u(t.label),11,ie)),64))])]),m(o("div",de,[o("div",null,[e[24]||(e[24]=o("label",{class:"block text-sm font-medium text-gray-700"},"Colaborador",-1)),o("div",ue,[m(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),onInput:G,onBlur:e[1]||(e[1]=()=>n.setTimeout(w,150)),type:"text",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500 uppercase",placeholder:"Digite matrícula ou nome...",autocomplete:"off",spellcheck:"false"},null,544),[[I,y.value]]),F.value?(d(),i("div",ce,"Buscando...")):c("",!0),N.value.length?(d(),i("div",me,[(d(!0),i(f,null,v(N.value,t=>(d(),i("button",{key:t.NUMCAD??t.numcad,type:"button",class:"block w-full px-4 py-2.5 text-left text-sm hover:bg-brand-50 transition-colors",onClick:s=>Z(t)},[o("span",fe,u(t.NUMCAD??t.numcad),1),o("span",ve," — "+u(t.NOMFUN??t.nomfun),1)],8,pe))),128))])):c("",!0)]),a(l).errors.numcad?(d(),i("div",ge,u(a(l).errors.numcad),1)):c("",!0),a(l).errors.nomfun?(d(),i("div",be,u(a(l).errors.nomfun),1)):c("",!0),m(o("input",{type:"hidden","onUpdate:modelValue":e[2]||(e[2]=t=>a(l).numcad=t)},null,512),[[I,a(l).numcad]]),m(o("input",{type:"hidden","onUpdate:modelValue":e[3]||(e[3]=t=>a(l).nomfun=t)},null,512),[[I,a(l).nomfun]]),U.value?(d(),i("div",xe,[e[19]||(e[19]=o("svg",{class:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})],-1)),_(" "+u(U.value),1)])):c("",!0),k.value?(d(),i("div",ye,[o("div",_e,[e[23]||(e[23]=o("svg",{class:"mt-0.5 h-5 w-5 flex-shrink-0 text-amber-600",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})],-1)),o("div",null,[e[22]||(e[22]=o("p",{class:"text-sm font-semibold text-amber-800"},"Avaliação bloqueada",-1)),o("p",he,[e[20]||(e[20]=_(" Este colaborador possui uma avaliação finalizada há menos de 6 meses ",-1)),M.value?(d(),i("span",ke,"("+u(M.value)+")",1)):c("",!0),e[21]||(e[21]=_(". Aguarde o prazo para criar uma nova avaliação. ",-1))])])])])):c("",!0)]),o("div",we,[o("div",null,[e[25]||(e[25]=o("label",{class:"block text-sm font-medium text-gray-700"},"Data da Avaliação",-1)),m(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>a(l).data_avaliacao=t),type:"date",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500"},null,512),[[I,a(l).data_avaliacao]]),a(l).errors.data_avaliacao?(d(),i("div",Ie,u(a(l).errors.data_avaliacao),1)):c("",!0)])]),o("div",null,[e[26]||(e[26]=o("label",{class:"block text-sm font-medium text-gray-700"},"Observação",-1)),m(o("textarea",{"onUpdate:modelValue":e[5]||(e[5]=t=>a(l).observacao=t),rows:"3",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"Opcional"},null,512),[[I,a(l).observacao]]),a(l).errors.observacao?(d(),i("div",Ae,u(a(l).errors.observacao),1)):c("",!0)])],512),[[A,g.value==="geral"]]),m(o("div",Ce,[e[27]||(e[27]=o("p",{class:"text-sm text-gray-500"}," Preencha os valores do Inventário Fatorial de Personalidade (IFP). ",-1)),o("div",De,[(d(),i(f,null,v(q,(t,s)=>o("div",{key:s},[o("label",Ne,u(t),1),o("input",{value:a(l).ifp[s],onInput:r=>R(a(l).ifp,s,r),type:"text",inputmode:"numeric",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0 %"},null,40,Me),a(l).errors[`ifp.${s}`]?(d(),i("div",Ue,u(a(l).errors[`ifp.${s}`]),1)):c("",!0)])),64))])],512),[[A,g.value==="ifp"]]),m(o("div",Be,[o("div",null,[e[32]||(e[32]=o("h3",{class:"mb-3 text-sm font-semibold text-gray-800"},"Perfis (%)",-1)),o("div",Fe,[o("div",null,[e[28]||(e[28]=o("label",{class:"block text-sm font-medium text-gray-700"},"Executor",-1)),o("input",{value:a(l).profiler.executor,onInput:e[6]||(e[6]=t=>b(a(l).profiler,"executor",t)),onBlur:e[7]||(e[7]=t=>x(a(l).profiler,"executor",t)),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Se)]),o("div",null,[e[29]||(e[29]=o("label",{class:"block text-sm font-medium text-gray-700"},"Planejador",-1)),o("input",{value:a(l).profiler.planejador,onInput:e[8]||(e[8]=t=>b(a(l).profiler,"planejador",t)),onBlur:e[9]||(e[9]=t=>x(a(l).profiler,"planejador",t)),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,je)]),o("div",null,[e[30]||(e[30]=o("label",{class:"block text-sm font-medium text-gray-700"},"Analista",-1)),o("input",{value:a(l).profiler.analista,onInput:e[10]||(e[10]=t=>b(a(l).profiler,"analista",t)),onBlur:e[11]||(e[11]=t=>x(a(l).profiler,"analista",t)),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Oe)]),o("div",null,[e[31]||(e[31]=o("label",{class:"block text-sm font-medium text-gray-700"},"Comunicador",-1)),o("input",{value:a(l).profiler.comunicador,onInput:e[12]||(e[12]=t=>b(a(l).profiler,"comunicador",t)),onBlur:e[13]||(e[13]=t=>x(a(l).profiler,"comunicador",t)),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Ve)])])]),o("div",null,[e[34]||(e[34]=o("h3",{class:"mb-3 text-sm font-semibold text-gray-800"},"Indicadores de Nível",-1)),o("div",$e,[(d(),i(f,null,v(H,(t,s)=>o("div",{key:s},[o("label",Pe,u(t),1),m(o("select",{"onUpdate:modelValue":r=>a(l).profiler[s]=r,class:z(["mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",a(l).profiler[s]===null?"text-gray-400":"text-gray-900"])},[e[33]||(e[33]=o("option",{value:null,class:"text-gray-400"},"Selecione...",-1)),(d(!0),i(f,null,v(C.niveis,r=>(d(),i("option",{key:r.ID??r.id,value:r.ID??r.id,class:"text-gray-900"},u(r.DESCRICAO??r.descricao),9,Te))),128))],10,Ee),[[X,a(l).profiler[s]]])])),64))])])],512),[[A,g.value==="profiler"]]),m(o("div",ze,[e[35]||(e[35]=o("p",{class:"text-sm text-gray-500"}," Preencha o valor para cada âncora de carreira. ",-1)),o("div",Le,[(d(!0),i(f,null,v(C.ancoraTipos,(t,s)=>(d(),i("div",{key:t.ID??t.id},[o("label",Re,u(t.NOME??t.nome),1),o("input",{value:a(l).ancoras[s].valor,onInput:r=>b(a(l).ancoras[s],"valor",r),onBlur:r=>x(a(l).ancoras[s],"valor",r),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,qe)]))),128))])],512),[[A,g.value==="ancoras"]]),m(o("div",He,[e[36]||(e[36]=o("p",{class:"text-sm text-gray-500"}," Preencha o valor para cada força pessoal, agrupadas por virtude. ",-1)),(d(!0),i(f,null,v(C.virtudes,t=>(d(),i("div",{key:t.ID??t.id,class:"rounded-lg border border-gray-200 p-4"},[o("h3",Ze,u(t.NOME??t.nome),1),o("div",Ge,[(d(!0),i(f,null,v(t.forcas,s=>(d(),i("div",{key:s.ID??s.id},[o("label",Je,u(s.NOME??s.nome),1),o("input",{value:a(l).forcas[B(s.ID??s.id)]?.valor,onInput:r=>b(a(l).forcas[B(s.ID??s.id)],"valor",r),onBlur:r=>x(a(l).forcas[B(s.ID??s.id)],"valor",r),type:"text",inputmode:"decimal",class:"mt-1 w-full rounded-lg border-gray-300 text-sm shadow-sm focus:border-brand-500 focus:ring-brand-500",placeholder:"0,00 %"},null,40,Ke)]))),128))])]))),128))],512),[[A,g.value==="forcas"]]),o("div",Qe,[o("button",{type:"button",onClick:e[14]||(e[14]=t=>O("RASCUNHO")),disabled:a(l).processing||!a(l).numcad||!a(l).nomfun||k.value,class:"inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-5 py-2.5 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-50 disabled:opacity-50 transition"},[a(l).processing&&a(l).status==="RASCUNHO"?(d(),i("svg",Xe,[...e[37]||(e[37]=[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):c("",!0),e[38]||(e[38]=_(" Salvar Rascunho ",-1))],8,We),o("button",{type:"button",onClick:e[15]||(e[15]=t=>O("FINALIZADA")),disabled:a(l).processing||!a(l).numcad||!a(l).nomfun||k.value,class:"inline-flex items-center gap-2 rounded-lg bg-brand-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-brand-700 disabled:opacity-50 transition"},[a(l).processing&&a(l).status==="FINALIZADA"?(d(),i("svg",eo,[...e[39]||(e[39]=[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):c("",!0),e[40]||(e[40]=_(" Finalizar Avaliação ",-1))],8,Ye),!a(l).numcad||!a(l).nomfun?(d(),i("span",oo," Selecione um colaborador para habilitar. ")):c("",!0)])],32)])])])])]),_:1})],64))}};export{ao as default};
