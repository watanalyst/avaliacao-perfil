import{u as F,m as L,p as j,g as r,a as l,b as a,h as R,w as x,d as t,l as T,f as h,e as O,o as i,k as c,F as A,r as I,t as _,i as P,n as $,A as z,q as w,j as M}from"./app-BFVYraDF.js";import{_ as H}from"./AuthenticatedLayout-slXQefgB.js";import{_ as p,a as y,b as f}from"./TextInput-C5av4InS.js";import{P as G}from"./PrimaryButton-FV82ErwS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"py-8"},K={class:"mx-auto max-w-2xl sm:px-6 lg:px-8"},Q={class:"overflow-hidden rounded-2xl bg-white shadow-lg ring-1 ring-gray-900/5"},W={class:"p-6"},X={class:"mb-6 flex items-center justify-between"},Y={key:0,class:"mt-1 text-sm text-gray-500"},Z={key:1,class:"absolute z-10 mt-2 w-full overflow-hidden rounded-md border bg-white shadow-lg"},ee=["onClick"],se={class:"font-semibold"},oe={class:"text-gray-600"},te={key:2,class:"mt-2 text-sm text-gray-500"},ae={key:0,class:"mt-1 text-xs text-gray-600"},le={class:"font-semibold"},ne={class:"flex items-center gap-3"},re={key:0,class:"text-sm text-gray-500"},fe={__name:"Create",setup(ie){const e=F({numcad:"",name:"",email:"",password:"",password_confirmation:"",role:null}),q=()=>{e.post(route("users.store"),{onFinish:()=>e.reset("password","password_confirmation")})},u=w(""),b=w(null),m=w([]),v=w(!1);let k=null;const g=M(()=>!e.numcad||!e.name?"":`${e.numcad} - ${e.name}`),B=M(()=>{const n=u.value.trim();return e.numcad&&e.name?!1:!v.value&&n.length>=2&&m.value.length===0});function V(n){b.value&&!b.value.contains(n.target)&&d()}function C(n){n.key==="Escape"&&d()}L(()=>{document.addEventListener("click",V),document.addEventListener("keydown",C)}),j(()=>{document.removeEventListener("click",V),document.removeEventListener("keydown",C)});function d(){m.value=[]}function U(){e.numcad="",e.name=""}function E(n){const s=n.NUMCAD??n.numcad??"",o=(n.NOMFUN??n.nomfun??"").toString().toUpperCase();e.numcad=s,e.name=o,u.value=`${s} - ${o}`,d()}function D(){clearTimeout(k);const s=(u.value||"").toUpperCase(),o=s.trim();if(u.value=s,!o){U(),d();return}if(g.value&&o!==g.value&&U(),o.length<2&&!/^\d+$/.test(o)){d();return}k=setTimeout(async()=>{v.value=!0;try{const N=route("colaboradores.index")+`?q=${encodeURIComponent(o)}`,S=await fetch(N,{headers:{Accept:"application/json"}});if(!S.ok){d();return}m.value=await S.json()}finally{v.value=!1}},250)}return(n,s)=>(i(),r(A,null,[l(a(R),{title:"Novo Usuário"}),l(H,null,{default:x(()=>[t("div",J,[t("div",K,[t("div",Q,[s[11]||(s[11]=t("div",{class:"h-1.5 bg-gradient-to-r from-brand-600 via-brand-500 to-brand-700"},null,-1)),t("div",W,[t("div",X,[s[7]||(s[7]=t("h2",{class:"text-xl font-bold text-gray-900"},"Novo Usuário",-1)),l(a(T),{href:n.route("users.index"),class:"inline-flex items-center gap-1.5 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-50 transition"},{default:x(()=>[...s[6]||(s[6]=[t("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})],-1),h(" Voltar ",-1)])]),_:1},8,["href"])]),t("form",{onSubmit:O(q,["prevent"]),class:"space-y-6"},[t("div",null,[l(p,{for:"search",value:"Colaborador (Senior)"}),t("div",{ref_key:"wrapper",ref:b,class:"relative"},[l(y,{id:"search",type:"text",class:"mt-1 block w-full uppercase",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=o=>u.value=o),onInput:D,onBlur:s[1]||(s[1]=()=>n.setTimeout(d,150)),placeholder:"Digite matrícula ou nome...",autocomplete:"off",spellcheck:"false"},null,8,["modelValue"]),v.value?(i(),r("div",Y," Buscando... ")):c("",!0),m.value.length?(i(),r("div",Z,[(i(!0),r(A,null,I(m.value,o=>(i(),r("button",{key:o.NUMCAD??o.numcad,type:"button",class:"block w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:N=>E(o)},[t("span",se,_(o.NUMCAD??o.numcad),1),t("span",oe," - "+_(o.NOMFUN??o.nomfun),1)],8,ee))),128))])):c("",!0),B.value?(i(),r("div",te," Nenhum colaborador encontrado. ")):c("",!0)],512),g.value?(i(),r("div",ae,[s[8]||(s[8]=h(" Selecionado: ",-1)),t("span",le,_(g.value),1)])):c("",!0),l(f,{class:"mt-2",message:a(e).errors.numcad},null,8,["message"])]),t("div",null,[l(p,{for:"email",value:"E-mail"}),l(y,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:a(e).email,"onUpdate:modelValue":s[2]||(s[2]=o=>a(e).email=o),required:"",autocomplete:"off"},null,8,["modelValue"]),l(f,{class:"mt-2",message:a(e).errors.email},null,8,["message"])]),t("div",null,[l(p,{for:"role",value:"Perfil"}),P(t("select",{id:"role","onUpdate:modelValue":s[3]||(s[3]=o=>a(e).role=o),class:$(["mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",a(e).role===null?"text-gray-400":"text-gray-900"])},[...s[9]||(s[9]=[t("option",{value:null,class:"text-gray-400"},"Selecione...",-1),t("option",{value:"AVALIADOR",class:"text-gray-900"},"Avaliador",-1),t("option",{value:"RH",class:"text-gray-900"},"Avaliador / Admin",-1)])],2),[[z,a(e).role]]),l(f,{class:"mt-2",message:a(e).errors.role},null,8,["message"])]),t("div",null,[l(p,{for:"password",value:"Senha"}),l(y,{id:"password",type:"password",class:"mt-1 block w-full",modelValue:a(e).password,"onUpdate:modelValue":s[4]||(s[4]=o=>a(e).password=o),required:"",autocomplete:"new-password"},null,8,["modelValue"]),l(f,{class:"mt-2",message:a(e).errors.password},null,8,["message"])]),t("div",null,[l(p,{for:"password_confirmation",value:"Confirmar Senha"}),l(y,{id:"password_confirmation",type:"password",class:"mt-1 block w-full",modelValue:a(e).password_confirmation,"onUpdate:modelValue":s[5]||(s[5]=o=>a(e).password_confirmation=o),required:"",autocomplete:"new-password"},null,8,["modelValue"]),l(f,{class:"mt-2",message:a(e).errors.password_confirmation},null,8,["message"])]),t("div",ne,[l(G,{class:$({"opacity-25":a(e).processing}),disabled:a(e).processing||!a(e).numcad||!a(e).name},{default:x(()=>[...s[10]||(s[10]=[h(" Criar Usuário ",-1)])]),_:1},8,["class","disabled"]),a(e).processing?(i(),r("span",re,"Salvando...")):c("",!0)])],32)])])])])]),_:1})],64))}};export{fe as default};
